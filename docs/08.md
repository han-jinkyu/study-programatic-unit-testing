# 8. 깔끔한 코드로 리팩토링하기

## 작은 리팩토링

- 코드를 리팩토링한다는 것은 기존 기능은 그대로 유지하면서 코드의 하부 구조를 건강하게 변형하는 것이다.
- 하지만 마음대로 코드 구조를 바꾸는 것은 위험하다.
- 이럴 때 적절한 보호 장치가 있는지 확인할 필요가 있는데 그것이 바로 `테스트`다.

### 리팩토링의 기회

- iloveyouboss_16/src/iloveyouboss/Profile.java

### 메서드 추출: 두 번째로 중요한 리팩토링 친구

- 리팩토링의 가장 중요한 요소는 `이름 짓기(rename)`이다. 대상은 클래스, 메서드, 모든 종류의 변수다.
- 실습의 목표는 matches() 메서드의 복잡도를 줄여 코드가 무엇을 담당하는지 그 정책을 쉽게 이해하는 것이다.

```java
public boolean matches(Criteria criteria) {
    // ...
    for (Criterion criterion: criteria) {
        // ...
        boolean match = 
            criterion.getWeight() == Weight.DontCare ||
            answer.match(criterion.getAnswer());
        // ...
    }
    // ...
}
```

```java
public boolean matches(Criteria criteria) {
    // ...
    for (Criterion criterion: criteria) {
        // ...
        boolean match = matches(criterion, answer);
        // ...
    }
    // ...
}

private boolean matches(Criterion criterion, Answer answer) {
    return criterion.getWeight() == Weight.DontCare ||
        answer.match(criterion.getAnswer());
}
```

- 할당 부분을 별도의 메서드로 추출하여 복잡성을 고립시킨다.
- 조건이 답변과 어떻게 매치되는지 알고 싶다면 새로 추출된 matches() 메서드로 이동한다.
- 코드를 안전하게 옮길 수 있는 능력은 단위 테스트의 가장 중요한 이점이다.

---
[Home](../README.md)
